<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Wrapped - Your Personal Stats</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé¨ YouTube Wrapped</h1>
            <p class="subtitle">Discover your YouTube viewing stats - Spotify Wrapped style!</p>
        </header>

        <main>
            <!-- Upload Section -->
            <section id="upload-section" class="card">
                <h2>Get Started</h2>
                <p>Choose how you want to analyze your YouTube data:</p>
                
                <div class="how-to">
                    <details>
                        <summary>üìã How to get your watch history</summary>
                        <ol>
                            <li>Go to <a href="https://takeout.google.com/" target="_blank">Google Takeout</a></li>
                            <li>Click "Deselect all"</li>
                            <li>Select only <strong>YouTube ‚Üí history</strong></li>
                            <li>Click "Next step" and "Create export"</li>
                            <li>Wait for email (1-4 hours)</li>
                            <li>Download, extract, and find <code>watch-history.json</code></li>
                        </ol>
                    </details>
                </div>

                <div class="upload-area">
                    <input type="file" id="file-input" accept=".json" />
                    <label for="file-input" class="file-label">
                        <span class="upload-icon">üìÅ</span>
                        <span class="upload-text">Choose watch-history.json</span>
                    </label>
                </div>

                <div class="year-selector">
                    <label for="year-select">Analyze year:</label>
                    <select id="year-select">
                        <option value="2025">2025</option>
                        <option value="2024" selected>2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="all">All Time</option>
                    </select>
                </div>

                <div class="oauth-section">
                    <h3>üîê Sign in with Google (Quick Analysis)</h3>
                    <p class="oauth-description">Analyze your liked videos and subscriptions without downloading files.</p>
                    
                    <div class="oauth-warning">
                        <strong>‚ö†Ô∏è Limited Data:</strong> OAuth can only access liked videos (~10-20% of what you watch). 
                        For complete watch history, use Google Takeout above.
                    </div>
                    
                    <div id="google-signin-container">
                        <div id="g_id_onload"
                             data-client_id="YOUR_CLIENT_ID_HERE"
                             data-callback="handleCredentialResponse"
                             data-auto_prompt="false">
                        </div>
                        <div class="g_id_signin" 
                             data-type="standard"
                             data-size="large"
                             data-theme="filled_black"
                             data-text="signin_with"
                             data-shape="rectangular"
                             data-logo_alignment="left">
                        </div>
                    </div>
                    
                    <button id="signout-btn" class="secondary-btn" style="display: none;">Sign Out</button>
                    <div id="oauth-status" class="oauth-status" style="display: none;">
                        <span class="status-icon">‚úì</span>
                        <span id="oauth-user">Signed in</span>
                    </div>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="api-section">
                    <details>
                        <summary>‚ö° Enhanced Mode - API Key (Optional)</summary>
                        <div class="api-content">
                            <p><strong>For Takeout file enrichment:</strong></p>
                            <p class="api-description">Upload watch history + API key for enhanced features:</p>
                            <ul>
                                <li>‚úÖ <strong>Exact watch time</strong> (instead of estimates)</li>
                                <li>‚úÖ <strong>Video categories</strong> (Music, Gaming, Education, etc.)</li>
                                <li>‚úÖ <strong>Category insights</strong> and trends</li>
                            </ul>
                            <input type="text" id="api-key" placeholder="YouTube API Key (optional)" />
                            <a href="https://console.cloud.google.com/apis/credentials" target="_blank" class="api-help">Get API Key ‚Üí</a>
                        </div>
                    </details>
                </div>

                <button id="analyze-btn" class="primary-btn">Analyze My Stats</button>

                <div class="privacy-notice">
                    <span>üîí</span> Your data is processed entirely in your browser. Nothing is uploaded to our servers.
                </div>
                
                <div class="info-box">
                    <strong>üí° Note:</strong> For most accurate watch history, use <strong>Google Takeout</strong>. 
                    API-only mode can only access liked videos (not complete watch history).
                </div>
            </section>

            <!-- Loading Section -->
            <section id="loading-section" class="card hidden">
                <div class="loader"></div>
                <p>Analyzing your YouTube history...</p>
            </section>

            <!-- Results Section -->
            <section id="results-section" class="hidden">
                <div class="card results-header">
                    <h2 id="results-title">üé¨ YOUR YOUTUBE WRAPPED 2024 üé¨</h2>
                </div>
                
                <div class="card key-metrics">
                    <h3>üìä Your Key Stats</h3>
                    <div class="key-metrics-grid">
                        <div class="key-metric">
                            <span class="metric-label">Minutes Watched</span>
                            <span class="metric-value" id="key-minutes">0</span>
                        </div>
                        <div class="key-metric">
                            <span class="metric-label">Videos Watched</span>
                            <span class="metric-value" id="key-videos">0</span>
                        </div>
                        <div class="key-metric">
                            <span class="metric-label">Top Channel</span>
                            <span class="metric-value" id="key-channel">-</span>
                        </div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üì∫</div>
                        <div class="stat-value" id="total-videos">0</div>
                        <div class="stat-label">Videos Watched</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-value" id="watch-time">0</div>
                        <div class="stat-label">Watch Time</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üï¢</div>
                        <div class="stat-value" id="total-minutes">0</div>
                        <div class="stat-label">Minutes Watched</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-value" id="unique-videos">0</div>
                        <div class="stat-label">Unique Videos</div>
                    </div>
                </div>

                <div class="card">
                    <h3>üèÜ Videos Watched by Channel</h3>
                    <p class="section-description">Your most-watched channels this period</p>
                    <div id="top-channels" class="channel-list"></div>
                </div>

                <div class="card">
                    <h3>üìÖ Monthly Breakdown</h3>
                    <div id="monthly-chart" class="chart"></div>
                </div>

                <div class="card" id="categories-card" style="display: none;">
                    <h3>üé¨ Video Categories</h3>
                    <div id="categories-chart" class="chart"></div>
                </div>

                <div class="share-section">
                    <button id="share-btn" class="secondary-btn">üì§ Share Your Stats</button>
                    <button id="reset-btn" class="secondary-btn">üîÑ Analyze Another Year</button>
                </div>
            </section>
        </main>

        <footer>
            <p>Made with ‚ù§Ô∏è for YouTube enthusiasts | <a href="https://github.com/erinmikailstaples/youtube-stats" target="_blank">View on GitHub</a></p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
